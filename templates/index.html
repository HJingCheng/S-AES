<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>SAES 加密/解密</title>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/bootstrap-icon.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
</head>
<body>

<div class="container mt-5">
    <h1 class="text-center">SAES 加密/解密</h1>
    <div class="section mb-4">
        <h3>加解密</h3>
        <div class="row mt-4">
            <!-- 加密类型选择：比特、ASCII、双加密、三加密 -->
            <div class="col-md-12">
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="encryptionType" id="bitEncrypt" value="bit"
                           checked>
                    <label class="form-check-label" for="bitEncrypt">Bits</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="encryptionType" id="asciiEncrypt" value="ascii">
                    <label class="form-check-label" for="asciiEncrypt">ASCII</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="encryptionType" id="doubleEncrypt"
                           value="double">
                    <label class="form-check-label" for="doubleEncrypt">双重加密</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="encryptionType" id="triEncrypt" value="tri">
                    <label class="form-check-label" for="triEncrypt">三重加密</label>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="input-group mb-3">
                    <span class="input-group-text"><i class="bi bi-key"></i></span>
                    <input type="text" class="form-control" id="keyInput" placeholder="请输入密钥">
                </div>
            </div>
            <div class="col-md-6">
                <div class="input-group mb-3">
                    <span class="input-group-text"><i class="bi bi-text-left"></i></span>
                    <input type="text" class="form-control" id="textInput"
                           placeholder="请输入bit或者字符">
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <button id="encryptBtn" class="btn btn-primary"><i class="bi bi-lock-fill"></i> 加密</button>
            </div>
            <div class="col-md-6">
                <button id="decryptBtn" class="btn btn-secondary"><i class="bi bi-unlock-fill"></i> 解密</button>
            </div>
        </div>
        <div class="card mt-4">
            <div class="card-header">
                <p>结果</p>
            </div>
            <div class="card-body" id="outputAreaCard">
                <p id="outputText"></p>
            </div>
        </div>
    </div>

    <!-- 添加破解部分 -->
    <hr class="my-4">
    <div class="section mb-4">
        <h3>破解</h3>
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="input-group mb-3">
                    <span class="input-group-text"><i class="bi bi-file-text"></i></span>
                    <input type="text" class="form-control plaintext" placeholder="输入明文">
                </div>
            </div>
            <div class="col-md-6">
                <div class="input-group mb-3">
                    <span class="input-group-text"><i class="bi bi-file-earmark-lock2"></i></span>
                    <input type="text" class="form-control ciphertext" placeholder="输入密文">
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <button class="btn btn-success" id="addPairBtn">
                    <i class="bi bi-plus-circle-fill"></i> 添加对
                </button>
            </div>
            <div class="col-md-6">
                <button class="btn btn-danger forceBtn">
                    <i class="bi bi-dash-circle-fill"></i> 进行破解
                </button>
            </div>
        </div>
        <div class="card mt-4">
            <div class="card-header">
                <p>已添加对</p>
            </div>
            <div class="card-body" id="outputAreaPair">
                <ul id="pairsList" class="list-group list-group-flush"></ul>
            </div>
        </div>
        <div class="card mt-4">
            <div class="card-header">
                <p>所有找到的密钥</p>
            </div>
            <div class="card-body">
                <ul id="keysList" class="list-group list-group-flush"></ul>
            </div>
            <div class="card-footer text-muted" id="timeTaken">
                <!-- 时间将在这里被显示 -->
            </div>
        </div>
    </div>
    <hr class="my-4">
    <!-- CBC模式部分 -->
    <div class="section mb-4">
        <h3>CBC模式 - S-AES加密/解密</h3>

        <!-- 初始向量输入框 -->
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="input-group mb-3">
                    <span class="input-group-text"><i class="bi bi-vinyl"></i></span>
                    <input type="text" class="form-control" id="ivInput" placeholder="请输入16位初始向量 (IV)">
                </div>
            </div>
        </div>

        <!-- 长明文输入框 -->
        <div class="row mt-4">
            <div class="col-md-12">
                <textarea class="form-control" id="longTextInput" rows="4"
                          placeholder="请输入要加密的长明文"></textarea>
            </div>
        </div>

        <!-- 加密按钮 -->
        <div class="row mt-4">
            <div class="col-md-6">
                <button id="encryptCBCBtn" class="btn btn-primary"><i class="bi bi-lock-fill"></i> CBC加密</button>
            </div>
            <div class="col-md-6">
                <button id="decryptCBCBtn" class="btn btn-secondary"><i class="bi bi-unlock-fill"></i> CBC解密</button>
            </div>
        </div>

        <!-- 密文修改区域 -->
        <div class="row mt-4">
            <div class="col-md-12">
                <h5>篡改密文：</h5>
                <textarea class="form-control" id="cipherTextEdit" rows="4"
                          placeholder="密文会在这里显示，你可以对其进行修改"></textarea>
            </div>
        </div>

        <!-- 解密结果显示区 -->
        <div class="row mt-4">
            <div class="col-md-12">
                <h5>解密结果：</h5>
                <p id="decryptedTextOutput"></p>
            </div>
        </div>
    </div>
    <div class="toast" id="emptyToast" role="alert" aria-live="assertive" aria-atomic="true"
         style="position: fixed; top: 20px; right: 20px;">
        <div class="toast-header">
            <strong class="me-auto"><i class="bi bi-exclamation-circle-fill" style="color: #f5d701"></i> 通知</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" id="toastBody">
        </div>
    </div>
</div>

<script src="/static/js/bootstrap.bundle.min.js"></script>
<script src="/js/encrypt.js"></script>
</body>
</html>
